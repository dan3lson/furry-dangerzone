<% provide(:title, @word.name.capitalize) %>
<% provide(:header, @word.name.capitalize) %>

<% if logged_in? %>
  <div class="row lead">
    <div class="center">
      <%= mastery_circle(@word, @user_word) %>

      <br>

      <% if @user_word.fundamental_completed? %>
        <span class="data-url pointer leksi-green hover"
              data-url="<%= fund_game_link(@word.id) %>">
          <i class="fa fa-gamepad"></i>
          Fundamentals
        </span>
      <% else %>
        <span class="data-url pointer hover"
              data-url="<%= fund_game_link(@word.id) %>">
          <i class="fa fa-gamepad"></i>
          Fundamentals
        </span>
      <% end %>

      |

      <% if ready_for_jeopardy?(current_user, @user_word) %>
        <span class="data-url pointer hover"
          data-url="<%= jeop_game_link(@word.id) %>">
          <i class="fa fa-gamepad"></i>
          Jeopardy
        </span>
      <% elsif @user_word.jeopardy_completed? %>
        <% if current_user.has_enough_jeopardy_words? %>
          <span class="data-url pointer leksi-green hover"
            data-url="<%= jeop_game_link(@word.id) %>">
            <i class="fa fa-gamepad"></i>
            Jeopardy
          </span>
        <% else %>
          <span class="data-url pointer leksi-green hover"
                data-toggle="popover"
                title="Why is this game locked?"
                data-content="To activate this Jeoapardy game, you need to
                play the Fundamentals game for at least 3 other words."
                data-placement="bottom">
            Jeopardy
          </span>
          <i class="fa fa-lock"></i>
        <% end %>
      <% else %>
        <span class="data-url pointer hover"
        data-toggle="popover"
        title="Why is this game locked?"
        data-content="To activate this Jeoapardy game, you need to
        play the Fundamentals for this word first."
        data-placement="bottom">
          Jeopardy
        </span>
        <i class="fa fa-lock"></i>
      <% end %>

      |

      <% if @user_word.freestyle_completed? %>
        <span class="data-url pointer leksi-green hover"
          data-url="<%= free_game_link(@word.id) %>">
          <i class="fa fa-gamepad"></i>
          Freestyle
        </span>
      <% elsif @user_word.current_game == "three" %>
        <span class="data-url pointer hover"
        data-url="<%= free_game_link(@word.id) %>">
          <i class="fa fa-gamepad"></i>
          Freestyle
        </span>
      <% else %>
        <span class="data-url pointer hover"
              data-toggle="popover"
              title="Why is this game locked?"
              data-content="To activate this Freestyle game, you need to
              play Jeopardy for this word."
              data-placement="bottom">
          Freestyle
        </span>
        <i class="fa fa-lock"></i>
      <% end %>
    </div>
  </div>

  <hr>
<% end %>

<div>
  <%= render "words/word_details", word: @word %>
</div>

<% if logged_in? %>
  <% if Word.untagged_for(current_user).include?(@word) %>
    <div>
      <% unless current_user.has_tags? %>
        <hr>

        <p>
          Tags help you organize your words by grouping them.
          <span class="basic-apple-blue-link">
            <%= link_to "Create your first tag", new_tag_path %> now.
          </span>
        </p>

        <%= render "tags/form" %>

        <hr>
      <% end %>

    </div>

  <% else %>
    <br>

    <% tags_for(current_user, @word).each do |tag| %>

      <div class="tags-for-a-word">
        <div class="tag">
          <div class="basic-black-link inline-block">
            <i class="fa fa-tag"></i>
            <%= tag.name.truncate(30) %>
          </div>
          &nbsp;
          &nbsp;
          <div class="tag-on-word-show-page inline-block pull-right">
            <%= render "tags/remove_tag_btn_word_show_page",
              word: @word, tag: tag %>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>

  <div class="clear"></div>

  <% unless unused_tags(current_user, @word).first.nil? %>
    <% if tags_exist?(current_user, @word) %>
      <br>
    <% end %>

    <div class="well">
      <h4>
        Add Tags
        <small>Choose one of your Tags to group this word.</small>
      </h4>

      <%= form_for :user_word_tag, url: user_word_tag_path,
        method: :post do |f| %>
        <%= hidden_field_tag :id, @word.id %>
        <%= f.label :tag_id, "Tags", class: "sr-only" %>
        <%= f.collection_select :tag_id, unused_tags(current_user, @word),
          :id, :name, prompt: true %>
        <%= f.submit class: "btn btn-default btn-sm", value: "add" %>
      <% end %>
    </div>

    <hr>
  <% end %>
<% end %>

<% if logged_in? %>
  <% if @user_word.freestyle_completed? %>
    <div class="box-shadow-border">
      <h4>Freestyle Game Responses</h4>

      <div class="row">
        <div class="col-sm-3">
          <h5>Semantic Map</h5>
          <% @semantic_map_responses.each_with_index do |r, i| %>
            <p>
              <%= i + 1 %>. <%= r %>
            </p>
          <% end %>
        </div>

        <div class="col-sm-3">
          <h5>Word Map</h5>
          <% @word_map_responses.each_with_index do |r, i| %>
            <p>
              <%= i + 1 %>. <%= r %>
            </p>
          <% end %>
        </div>

        <div class="col-sm-3">
          <h5>Definition Map</h5>
          <% @definition_map_responses.each_with_index do |r, i| %>
            <p>
              <%= i + 1 %>. <%= r %>
            </p>
          <% end %>
        </div>

        <div class="col-sm-3">
          <h5>Sentence Examples</h5>
          <% @sentence_responses.each_with_index do |r, i| %>
            <p>
              <%= i + 1 %>. <%= r %>
            </p>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
<% end %>

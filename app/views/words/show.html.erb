<% provide(:title, @word.name.capitalize) %>
<% provide(:header, @word.name.capitalize) %>

<% if logged_in? %>
  <div>
    <div class="row" align="center">

      <div class="col-xs-4 data-url pointer fund-show-game-circle-container"
           data-url="/fundamentals?word_id=<%= @word.id %>">
        <div class="fund-show-game-circle white hover">
          <% if @user_word.fundamental_completed? %>
            &#10004;
          <% else %>
            &#9658;
          <% end %>
        </div>
      </div>

      <div class="col-xs-4 data-url jeop-show-game-circle-container">
        <% if ready_for_jeopardy?(current_user, @user_word) %>

          <div class="jeop-show-game-circle pointer data-url white hover"
               data-url="/jeopardy?word_id=<%= @word.id %>">&#9658;</div>

        <% elsif @user_word.jeopardy_completed? %>

          <% if current_user.has_enough_jeopardy_words? %>
            <div class="jeop-show-game-circle white pointer data-url hover"
                 data-url="/jeopardy?word_id=<%= @word.id %>">&#10004;</div>
          <% else %>
            <div class="jeop-show-game-circle"
              data-toggle="popover" title="Why is this game locked?"
              data-content="To activate this Jeoapardy game, you need to
              (1) complete the Fundamentals for this word and (2) play
              the Fundamentals game for at least 4 words."
              data-placement="bottom">
              <span class="glyphicon glyphicon-lock"></span>
            </div>
          <% end %>

        <% else %>
          <div class="jeop-show-game-circle"
            data-toggle="popover" title="Why is this game locked?"
            data-content="To activate this Jeoapardy game, you need to
            (1) complete the Fundamentals for this word and (2) play
            the Fundamentals game for at least 4 words."
            data-placement="bottom">
            <span class="glyphicon glyphicon-lock"></span>
          </div>
        <% end %>
      </div>

      <% if @user_word.freestyle_completed? %>
        <div class="col-xs-4 free-show-game-circle-container pointer data-url"
             data-url="/freestyle?word_id=<%= @word.id %>">
            <div class="free-show-game-circle white hover">&#10004;</div>

      <% elsif @user_word.current_game == "three" %>
        <div class="col-xs-4 free-show-game-circle-container pointer data-url"
             data-url="/freestyle?word_id=<%= @word.id %>">
            <div class="free-show-game-circle white hover">&#9658;</div>

      <% else %>
        <div class="col-xs-4 free-show-game-circle-container">
          <div class="free-show-game-circle pointer"
            data-toggle="popover" title="Why is this game locked?"
            data-content="To activate this Freestyle game, play Jeopardy for
            this word first!"
            data-placement="bottom">
            <span class="glyphicon glyphicon-lock"></span>
          </div>
      <% end %>
        </div>
      </div>
  </div>

  <br>
<% end %>

<div>
  <%= render "words/word_details", word: @word %>
</div>

<% if logged_in? %>
  <% if Word.untagged_for(current_user).include?(@word) %>
    <div>
      <% unless current_user.has_tags? %>
        <hr>

        <p>
          Tags help you organize your words by grouping them.
          <span class="basic-apple-blue-link">
            <%= link_to "Create your first tag", new_tag_path %> now.
          </span>
        </p>

        <%= render "tags/form" %>

        <hr>
      <% end %>

    </div>

  <% else %>
    <br>

    <% tags_for(current_user, @word).each do |tag| %>

      <div class="tags-for-a-word">
        <div class="tag">
          <div class="basic-black-link inline-block">
            <span class="glyphicon glyphicon-tag" aria-hidden="true"></span>
            &nbsp;
            <%= link_to tag.name.truncate(30), tag %>
          </div>
          &nbsp;
          <div class="tag-on-word-show-page inline-block pull-right">
            <%= render "tags/remove_tag_btn_word_show_page",
              word: @word, tag: tag %>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>

  <div class="clear"></div>

  <% unless unused_tags(current_user, @word).first.nil? %>
    <% if tags_exist?(current_user, @word) %>
      <br>
    <% end %>

    <div class="well">
      <h4>
        Add Tags
        <small>Choose one of your Tags to group this word.</small>
      </h4>

      <%= form_for :user_word_tag, url: user_word_tag_path,
        method: :post do |f|
      %>
        <%= hidden_field_tag :id, @word.id %>
        <%= f.label :tag_id, "Tags", class: "sr-only" %>
        <%=
          f.collection_select :tag_id,
          unused_tags(current_user, @word), :id, :name,
          prompt: true
        %>
        <%= f.submit class: "btn btn-default btn-sm", value: "add" %>
      <% end %>
    </div>

    <hr>
  <% end %>
<% end %>

<% if logged_in? %>
  <% if @user_word.freestyle_completed? %>
    <div class="box-shadow-border">
      <h4>Freestyle Game Responses</h4>

      <div class="row">
        <div class="col-sm-3">
          <h5>Semantic Map</h5>
          <% @semantic_map_responses.each_with_index do |r, i| %>
            <p>
              <%= i + 1 %>. <%= r %>
            </p>
          <% end %>
        </div>

        <div class="col-sm-3">
          <h5>Word Map</h5>
          <% @word_map_responses.each_with_index do |r, i| %>
            <p>
              <%= i + 1 %>. <%= r %>
            </p>
          <% end %>
        </div>

        <div class="col-sm-3">
          <h5>Definition Map</h5>
          <% @definition_map_responses.each_with_index do |r, i| %>
            <p>
              <%= i + 1 %>. <%= r %>
            </p>
          <% end %>
        </div>

        <div class="col-sm-3">
          <h5>Sentence Examples</h5>
          <% @sentence_responses.each_with_index do |r, i| %>
            <p>
              <%= i + 1 %>. <%= r %>
            </p>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
<% end %>

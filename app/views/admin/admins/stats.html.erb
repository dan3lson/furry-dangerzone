<% provide(:header, "Stats") %>

<div class="row">
	<div class="col-sm-6 col-offset-3">
		<div class="panel panel-default">
			<div class="panel-heading">General</div>
			<table class="table table-responsive table-bordered">
				<th></th>
				<th>Latest</th>
				<tr>
					<td># Users</td>
					<td><%= User.count %></td>
				</tr>
				<tr>
					<td>Num Logins</td>
					<td><%= User.sum(:num_logins) %></td>
				</tr>
			</table>
		</div>

		<div class="panel panel-default">
			<div class="panel-heading">Words</div>
			<table class="table table-responsive table-bordered">
				<th></th>
				<th>Latest</th>
				<tr>
					<td>Users w/o Words</td>
					<td>
						<%= User.where.not(id: UserWord.select(:user_id).uniq).count %>
					</td>
				</tr>
				<tr>
					<td>Users w/ Words</td>
					<td><%= User.where(id: UserWord.select(:user_id).uniq).count %></td>
				</tr>
				<tr>
					<td># UserWords</td>
					<td><%= UserWord.count %></td>
				</tr>
			</table>
		</div>

		<div class="panel panel-default">
			<div class="panel-heading">Tags</div>
			<table class="table table-responsive table-bordered">
				<th></th>
				<th>Latest</th>
				<tr>
					<td>Users w/o Tags</td>
					<td>
						<%= User.where.not(id: UserTag.select(:user_id).uniq).count %>
					</td>
				</tr>
				<tr>
					<td>Users w/Tags</td>
					<td>
						<%= User.where(id: UserTag.select(:user_id).uniq).count %>
					</td>
				</tr>
				<tr>
					<td>UserTags</td>
					<td><%= UserTag.count %></td>
				</tr>
			</table>
		</div>

		<div class="panel panel-default">
			<div class="panel-heading">Fundamental Games</div>
			<table class="table table-responsive table-bordered">
				<th></th>
				<th>Latest</th>
				<tr>
					<td>Fundamentals Completed</td>
					<td><%= UserWord.where.not(games_completed: 0).count %></td>
				</tr>
				<tr>
					<td>Time Spent Completing Fundamentals</td>
					<td><%= GameStat.where(game_id: 1).sum(:time_spent).to_s %></td>
				</tr>
				<tr>
					<td>Num Fundamentals Played</td>
					<td><%= GameStat.where(game_id: 1).sum(:num_played) %></td>
				</tr>
				<tr>
					<td>Fundamentals Not Completed</td>
					<td><%= UserWord.where(games_completed: 0).count %></td>
				</tr>
			</table>
		</div>

		<div class="panel panel-default">
			<div class="panel-heading">Jeopardy Games</div>
			<table class="table table-responsive table-bordered">
				<th></th>
				<th>Latest</th>
				<tr>
					<td>Jeopardys Completed</td>
					<td>
						<%= UserWord.where(games_completed: 2).count +
								UserWord.where(games_completed: 3).count %>
					</td>
				</tr>
				<tr>
					<td>Time Spent Completing Jeopardys</td>
					<td><%= GameStat.where(game_id: 2).sum(:time_spent).to_s %></td>
				</tr>
				<tr>
					<td>Num Jeopardys Played</td>
					<td><%= GameStat.where(game_id: 2).sum(:num_played) %></td>
				</tr>
				<tr>
					<td>Jeopardys Not Completed</td>
					<td><%= UserWord.select { |uw| uw.jeopardy_not_completed? }.count %></td>
				</tr>
				<tr>
					<td>Num Jeopardys Won</td>
					<td><%= GameStat.sum(:num_jeop_won) %></td>
				</tr>
				<tr>
					<td>Num Jeopardys Lost</td>
					<td><%= GameStat.sum(:num_jeop_lost) %></td>
				</tr>
			</table>
		</div>

		<div class="panel panel-default">
			<div class="panel-heading">Freestyle Games</div>
			<table class="table table-responsive table-bordered">
				<th></th>
				<th>Latest</th>
				<tr>
					<td>Freestyles Completed</td>
					<td><%= UserWord.where(games_completed: 3).count %></td>
				</tr>
				<tr>
					<td>Time Spent Completing Freestyles</td>
					<td><%= GameStat.where(game_id: 3).sum(:time_spent).to_s %></td>
				</tr>
				<tr>
					<td>Num Freestyles Played</td>
					<td><%= GameStat.where(game_id: 3).sum(:num_played) %></td>
				</tr>
				<tr>
					<td>Freestyles Not Completed</td>
					<td><%= UserWord.select { |uw| uw.freestyle_not_completed? }.count %></td>
				</tr>
			</table>
		</div>
	</div>
</div>

<% provide(:title, "Add") %>
<% provide(:header, "Add") %>

<div class="col-sm-8 col-sm-offset-2 add-look-up-word-container well">
  <%= render "searches/form" %>

  <br>

  <div class="center gray">
    <small>powered by the Macmillan Dictionary</small>
  </div>
</div>

<br>

<div class="clear"></div>

<% if @query %>
  <div class="search-results">
    <% if @search_results.class == String %>
      <p class="lead leksi-red center">
        <%= @search_results %>
      </p>
    <% else %>
      <% @search_results.each_with_index do |word, index| %>
        <div class="word-partial col-sm-8 col-sm-offset-2">
          <div class="box-shadow-border">
            <% if logged_in? %>
              <div class="pull-right">
                <%= form_for :user_word, url: user_word_path,
                  method: :post do |f| %>
                  <%= hidden_field_tag :id, word.id %>

                  <% if Rails.env.test? %>
                    <% if current_user.already_has_word?(word) %>
                      <%= link_to "remove", user_word_path(id: UserWord.find_by(
                          user: current_user,
                          word: word
                        ).id),
                        method: :delete
                      %>
                    <% else %>
                      <%= f.submit "add" %>
                    <% end %>
                  <% else %>
                    <% if current_user.already_has_word?(word) %>
                      <%= render "words/remove_word_btn_word_show_page",
                        word: word %>
                    <% else %>
                      <%= image_submit_tag("add_black_45.png",
                        class: "border-none") %>
                    <% end %>
                  <% end %>
                <% end %>
              </div>
            <% end %>

            <div>
              <%= render "words/word", word: word %>
            </div>

            <hr>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
<% end %>
